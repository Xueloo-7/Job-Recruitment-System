@model IEnumerable<Resume>
@{
    ViewData["Title"] = "Resumes";
}

<div class="profile-page">
    <div class="profile-nav">
        <a asp-action="Index" class="">Dashboard</a>
        <a asp-action="Info" class="">Information</a>
        <a asp-action="Summary" class="">Summary</a>
        <a asp-action="CareerHistory" class="">Career History</a>
        <a asp-action="Education" class="">Education</a>
        <a asp-action="Education" class="active">Resume</a>
    </div>

    <div class="profile-card">
        <h2 class="profile-title">上传简历</h2>
        <form asp-action="UploadResume" method="post" enctype="multipart/form-data" class="profile-form">
            <input type="file" name="file" accept=".pdf,.doc,.docx,.jpg,.png" required />
            <button type="submit" class="profile-btn">上传</button>
        </form>
    </div>

    <div class="profile-card">
        <h2 class="profile-title">已上传简历</h2>
        @if (Model?.Any() == true)
        {
            <ul>
                @foreach (var resume in Model)
                {
                    <li>
                        <a href="@resume.ImageUrl" target="_blank">查看 (@resume.CreatedAt.ToLocalTime().ToString("yyyy-MM-dd"))</a>

                        <!-- Delete -->
                        <button data-id="@resume.Id" class="action-btn delete delete-btn">Delete</button>
                    </li>
                }

            </ul>
        }
        else
        {
            <p>暂无简历</p>
        }
    </div>
</div>

@section Styles {
    <style>
        .profile-form input {
            margin-bottom: 30px;
        }
    </style>
    <link rel="stylesheet" href="~/css/profile.css" />
}

@section Scripts {
    <script>
        // Delete buttons
        document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', function (e) {
                e.preventDefault(); // 阻止默认跳转
                showConfirm("Are you sure you want to delete this resume?", function () {
                    const resumeId = btn.dataset.id;
                    window.location.href = `/Profile/DeleteResume/${resumeId}`;
                });
            });
        });
    </script>

}